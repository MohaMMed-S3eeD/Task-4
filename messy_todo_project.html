<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Messy ToDo</title>
    <meta charset="UTF-8" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  </head>
  <body>
    <h1>Todo List</h1>
    <input id="taskInput" type="text" title="input" />
    <button onclick="addTask()">Add Task</button>
    <ul id="taskList"></ul>

    <script>
      let Tasks = [];
      let counter = 0;

      // function validateInput
      const validateInput = (task) => {
        if (task === null || task.trim() === "") {
          alert("Please enter a valid task.");
          return false;
        }
        return true;
      };

      // function AddTask
      const addTask = () => {
        let task_Input = document.getElementById("taskInput");
        let task = task_Input.value;

        if (validateInput(task)) {
          Tasks[counter] = {
            id: counter,
            name: task,
            done: false,
          };
          counter++;
          task_Input.value = "";
          renderList();
        }
      };
      const renderList = () => {
        const ul = document.getElementById("taskList");
        ul.innerHTML = "";
        const fragment = document.createDocumentFragment();

        Tasks.forEach((task, index) => {
          const li = document.createElement("li");
          li.textContent = task.name;

          if (task.done) {
            li.style.textDecoration = "line-through";
          }

          const toggleButton = document.createElement("button");
          toggleButton.textContent = "Toggle";
          toggleButton.addEventListener("click", () => toggle(index));

          const deleteButton = document.createElement("button");
          deleteButton.textContent = "Delete";
          deleteButton.addEventListener("click", () => deleteTask(index));

          li.appendChild(toggleButton);
          li.appendChild(deleteButton);
          fragment.appendChild(li);
        });

        ul.appendChild(fragment);
      };

      // function toggle
      const toggle = (index) => {
        Tasks[index].done = !Tasks[index].done;
        renderList();
        let allDone = Tasks.length > 0 && Tasks.every((task) => task.done);
        if (allDone) {
          alert("All tasks done!");
        }
      };
      // function deleteTask
      const deleteTask = (i) => {
        Tasks = Tasks.filter((_, index) => index !== i);
        counter--;
        renderList();
      };
    </script>
  </body>
</html>
